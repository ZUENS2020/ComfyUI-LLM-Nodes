# ComfyUI ä½¿ç”¨æŒ‡å— - OpenRouter èŠ‚ç‚¹

## âœ… æµ‹è¯•ç»“æœ

æ‰€æœ‰æµ‹è¯•å‡å·²é€šè¿‡ï¼š
- âœ… èŠ‚ç‚¹å¯¼å…¥æˆåŠŸ
- âœ… Base Config åˆ›å»ºæˆåŠŸ
- âœ… Image Params é…ç½®æˆåŠŸ
- âœ… å›¾åƒç”ŸæˆæˆåŠŸï¼ˆ1024x1024ï¼‰
- âœ… ç«¯åˆ°ç«¯å·¥ä½œæµæµ‹è¯•é€šè¿‡

## ğŸš€ åœ¨ ComfyUI ä¸­ä½¿ç”¨

### æ­¥éª¤ 1ï¼šé‡å¯ ComfyUI
å®Œå…¨å…³é—­å¹¶é‡å¯ ComfyUIï¼Œç¡®ä¿åŠ è½½æ–°èŠ‚ç‚¹ã€‚

å¯åŠ¨æ—¶åº”è¯¥çœ‹åˆ°ï¼š
```
[ComfyUI-Gemini v4.0.0] Loaded (LiteLLM + OpenRouter).
  - LiteLLM nodes: Category 'Gemini-LiteLLM'
  - OpenRouter nodes: Category 'Gemini-OpenRouter'
```

### æ­¥éª¤ 2ï¼šæ·»åŠ èŠ‚ç‚¹

åœ¨ ComfyUI ä¸­å³é”® â†’ Add Node â†’ **`Gemini-OpenRouter`**

ä½ ä¼šçœ‹åˆ°ä»¥ä¸‹èŠ‚ç‚¹ï¼š

#### é…ç½®èŠ‚ç‚¹ï¼ˆåœ¨ `Gemini-OpenRouter/Config` æ–‡ä»¶å¤¹ï¼‰
1. **Base Config (OpenRouter)** - åŸºç¡€ API é…ç½®
2. **Chat Params (OpenRouter)** - èŠå¤©å‚æ•°
3. **Image Params (OpenRouter)** - å›¾åƒå‚æ•°

#### æ‰§è¡ŒèŠ‚ç‚¹ï¼ˆåœ¨ `Gemini-OpenRouter` æ–‡ä»¶å¤¹ï¼‰
4. **Chat (OpenRouter)** - èŠå¤©å¯¹è¯
5. **Image (OpenRouter)** - å›¾åƒç”Ÿæˆ

### æ­¥éª¤ 3ï¼šé…ç½®å›¾åƒç”Ÿæˆå·¥ä½œæµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Base Config (OpenRouter)â”‚
â”‚ - api_key: your key     â”‚
â”‚ - model: google/gemini-3-pro-image-preview
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Image Params (OpenRouter)â”‚
â”‚ - aspect_ratio: 1:1     â”‚
â”‚ - image_size: 1K        â”‚
â”‚ - temperature: 1.0      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Image (OpenRouter)    â”‚
â”‚ - prompt: "A cat..."    â”‚
â”‚ - n: 1                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  IMAGE  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ­¥éª¤ 4ï¼šé…ç½® Base Config

**Base Config (OpenRouter)** èŠ‚ç‚¹å‚æ•°ï¼š

- **api_key** (å¿…éœ€): ä½ çš„ OpenRouter API å¯†é’¥
  - ç¤ºä¾‹ï¼š`sk-or-v1-...`

- **model** (å¿…éœ€): æ¨¡å‹åç§°
  - æ¨èï¼š`google/gemini-3-pro-image-preview`
  - å¤‡é€‰ï¼š`google/gemini-2.5-flash-image`

- **api_base** (å¯é€‰): API åœ°å€
  - é»˜è®¤ï¼š`https://openrouter.ai/api/v1`

- **site_url** (å¯é€‰): ä½ çš„ç½‘ç«™ URL
  - ç”¨äº OpenRouter æ’åç»Ÿè®¡

- **site_name** (å¯é€‰): ä½ çš„ç½‘ç«™åç§°

### æ­¥éª¤ 5ï¼šé…ç½® Image Params

**Image Params (OpenRouter)** èŠ‚ç‚¹å‚æ•°ï¼š

- **base_config**: è¿æ¥ä» Base Config è¾“å‡º

- **aspect_ratio**: å®½é«˜æ¯”
  - `1:1` â†’ 1024Ã—1024 (æ­£æ–¹å½¢)
  - `16:9` â†’ 1344Ã—768 (å®½å±)
  - `4:3` â†’ 1184Ã—864
  - `9:16` â†’ 768Ã—1344 (ç«–å±)
  - æ›´å¤šé€‰é¡¹...

- **image_size**: åˆ†è¾¨ç‡
  - `1K` â†’ æ ‡å‡†åˆ†è¾¨ç‡ï¼ˆæ¨èï¼‰
  - `2K` â†’ é«˜åˆ†è¾¨ç‡
  - `4K` â†’ æœ€é«˜åˆ†è¾¨ç‡

- **temperature**: åˆ›é€ æ€§
  - `0.0` - ç¨³å®š
  - `0.5` - å¹³è¡¡
  - `1.0` - åˆ›æ„ï¼ˆæ¨èï¼‰

### æ­¥éª¤ 6ï¼šé…ç½® Image èŠ‚ç‚¹

**Image (OpenRouter)** èŠ‚ç‚¹å‚æ•°ï¼š

- **config**: è¿æ¥ä» Image Params è¾“å‡º

- **prompt** (å¿…éœ€): å›¾åƒæè¿°
  - ç¤ºä¾‹ï¼š`A cute cat sitting on a windowsill, sunny day`
  - ç¤ºä¾‹ï¼š`Beautiful sunset over mountains, vibrant colors`

- **n**: ç”Ÿæˆå›¾åƒæ•°é‡
  - èŒƒå›´ï¼š1-4
  - æ³¨æ„ï¼šå®é™…æ•°é‡å–å†³äºæ¨¡å‹

- **image_1 åˆ° image_5** (å¯é€‰): å‚è€ƒå›¾åƒ
  - å¯ä»¥è¿æ¥å…¶ä»–èŠ‚ç‚¹çš„å›¾åƒè¾“å‡º
  - ç”¨äºå›¾åƒä¿®æ”¹æˆ–å‚è€ƒ

- **additional_text** (å¯é€‰): é™„åŠ æ–‡æœ¬è¯´æ˜

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: æ‰¾ä¸åˆ° OpenRouter èŠ‚ç‚¹

**è§£å†³æ–¹æ³•ï¼š**
1. å®Œå…¨å…³é—­ ComfyUI
2. é‡æ–°å¯åŠ¨ ComfyUI
3. æ£€æŸ¥å¯åŠ¨æ—¥å¿—æ˜¯å¦æ˜¾ç¤ºåŠ è½½æˆåŠŸ
4. å³é”®èœå•æœç´¢ "OpenRouter"

### Q2: æç¤º "Missing API configuration"

**è§£å†³æ–¹æ³•ï¼š**
- æ£€æŸ¥ Base Config èŠ‚ç‚¹çš„è¿æ¥
- ç¡®ä¿ api_key å·²å¡«å†™
- ç¡®ä¿ model å·²å¡«å†™

### Q3: å›¾åƒç”Ÿæˆå¤±è´¥

**å¯èƒ½åŸå› ï¼š**
1. API å¯†é’¥æ— æ•ˆæˆ–é¢åº¦ä¸è¶³
2. æ¨¡å‹åç§°é”™è¯¯
3. ç½‘ç»œè¿æ¥é—®é¢˜

**è§£å†³æ–¹æ³•ï¼š**
- éªŒè¯ API å¯†é’¥ï¼šè®¿é—® https://openrouter.ai/keys
- æ£€æŸ¥æ¨¡å‹åç§°ï¼šä½¿ç”¨ `google/gemini-3-pro-image-preview`
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### Q4: è¿”å›æ–‡æœ¬è€Œéå›¾åƒ

**åŸå› ï¼š** æç¤ºè¯è¿‡äºå¤æ‚æˆ–åƒæ˜¯åœ¨æé—®

**è§£å†³æ–¹æ³•ï¼š**
- ä½¿ç”¨ç®€æ´çš„æè¿°æ€§æç¤ºè¯
- é¿å… "è¯·ç”Ÿæˆ..." è¿™æ ·çš„ç¤¼è²Œç”¨è¯­
- ç›´æ¥æè¿°è¦ç”Ÿæˆçš„å›¾åƒå†…å®¹
- ç¤ºä¾‹ï¼š`A red circle on white background` âœ…
- ç¤ºä¾‹ï¼š`Can you draw a red circle?` âŒ

### Q5: å›¾åƒè´¨é‡ä¸å¥½

**ä¼˜åŒ–å»ºè®®ï¼š**
1. ä½¿ç”¨æ›´è¯¦ç»†çš„æç¤ºè¯
2. è°ƒæ•´ temperature å‚æ•°ï¼ˆ0.7-1.0ï¼‰
3. å°è¯•ä¸åŒçš„ aspect_ratio
4. ä½¿ç”¨ 2K æˆ– 4K åˆ†è¾¨ç‡

## ğŸ“ æµ‹è¯•å‘½ä»¤

å¦‚æœä½ æƒ³æµ‹è¯•èŠ‚ç‚¹æ˜¯å¦æ­£ç¡®åŠ è½½ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œè¿è¡Œï¼š

```bash
cd ComfyUI\custom_nodes\ComfyUI-Gemini-LiteLLM
python test_e2e.py
```

è¿™ä¼šç”Ÿæˆä¸€ä¸ªæµ‹è¯•å›¾åƒï¼š`e2e_test_output.png`

## ğŸ¯ å¿«é€Ÿç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šç®€å•å›¾åƒç”Ÿæˆ
```
prompt: "A beautiful sunset over the ocean"
aspect_ratio: "16:9"
image_size: "1K"
```

### ç¤ºä¾‹ 2ï¼šè‚–åƒ
```
prompt: "Professional portrait of a woman, studio lighting, bokeh background"
aspect_ratio: "1:1"
image_size: "2K"
```

### ç¤ºä¾‹ 3ï¼šé£æ™¯
```
prompt: "Majestic mountain landscape, golden hour lighting, dramatic clouds"
aspect_ratio: "21:9"
image_size: "2K"
```

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥ ComfyUI æ§åˆ¶å°æ—¥å¿—
2. è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯å®‰è£…
3. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
4. è®¿é—®ï¼šhttps://github.com/ZUENS2020/ComfyUI-Gemini-LiteLLM/issues

## ğŸ‰ æˆåŠŸæ ‡å¿—

å½“ä¸€åˆ‡æ­£å¸¸æ—¶ï¼Œä½ åº”è¯¥ï¼š
1. åœ¨ ComfyUI ä¸­çœ‹åˆ° `Gemini-OpenRouter` æ–‡ä»¶å¤¹
2. èƒ½å¤Ÿæ·»åŠ æ‰€æœ‰ OpenRouter èŠ‚ç‚¹
3. æˆåŠŸç”Ÿæˆå›¾åƒå¹¶æ˜¾ç¤ºåœ¨é¢„è§ˆçª—å£
4. å›¾åƒå¯ä»¥ä¿å­˜åˆ°ç£ç›˜

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ¨
